import numpy as np
import matplotlib.pyplot as plt
plt.rcParams['text.usetex'] = True

results = {32: [(4083.188478843819, 0.29383875615894794),
  (2908.1601333550657, 0.20768826454877853),
  (3856.335066801987, 0.2720232247374952),
  (3386.3816071580145, 0.23760233679786325),
  (2756.263925537714, 0.24582835589535534),
  (3697.459028671593, 0.2359491060487926),
  (2976.327310282193, 0.24561556009575725),
  (3410.9842177231926, 0.2847028085961938),
  (3537.130998366022, 0.2208098261617124),
  (3321.7325995406927, 0.25314523791894317)],
 64: [(3302.8278281314915, 0.26578829111531377),
  (4580.35497784888, 0.24832448782399297),
  (4700.402407189324, 0.29310333356261253),
  (3737.053424222411, 0.29440741147845984),
  (3443.4108001019404, 0.3242108733393252),
  (3787.409862046134, 0.24905978189781308),
  (4137.369400314207, 0.33008415531367064),
  (3919.8263940198713, 0.27919911267235875),
  (4091.3437737505856, 0.21606851508840919),
  (3814.222719292812, 0.34029881190508604)],
 128: [(5738.325904062675, 0.25409699010197073),
  (5231.057765405749, 0.29175094328820705),
  (5952.427705552695, 0.3712655324488878),
  (5532.212596033384, 0.2957338057458401),
  (4417.25075122424, 0.37743237977847457),
  (5115.462977769171, 0.22988724894821644),
  (4651.031913319612, 0.35459600565955043),
  (4604.599971658254, 0.2920685338322073),
  (4488.141173260532, 0.37360132802277803),
  (5670.909630376683, 0.2567421863786876)],
 256: [(10906.94994194617, 0.33472985299304128), 
  (6027.202241964005, 0.32156913485378027), 
  (6665.504544416043, 0.3963730674237013), 
  (7884.86797302158, 0.39748603156767786), 
  (5314.41196460967, 0.471433929214254), 
  (5920.818671492637, 0.427265507215634), 
  (6151.9451536284505, 0.36323845237493515), 
  (6359.225889677499, 0.30247289105318487), 
  (6886.721579161634, 0.32606764920055866), 
  (5555.183688074802, 0.3068287493661046)]}

for dim in results.keys():
    plt.scatter(
        np.log(np.array([x[0] for x in results[dim]])),
        [x[1] for x in results[dim]],
        label=f'$d$={dim}'
    )


plt.xlabel('$R_A$')
plt.ylabel('Generalization gap')
plt.tight_layout()
plt.legend()
plt.show()

