\newpage
\subsection{Rademacher Complexity of ramp loss - two layers case}
\subsubsection{Problem Statement}
\textbf{Problem} : Consider the multi-class classification problem with $K \ge 2$ labels. Given a tuple of matrices $(M_1, M_2)$ (that represents initialized weight matrices). Define the following class of tuples of weight matrices:

\begin{align*}
    \mathcal{A} = \biggCurl{
        \bigRound{
            A_1, A_2
        } : \|A_1\|_\sigma \le s, \ \| (A_1 - M_1)^T \|_{2, 1} \le a_1, \ \| A_2 - M_2 \|_F \le a_2
    }
\end{align*}

\noindent Where $a_1, a_2 > 0$. $\|.\|_\sigma$ denotes the spectral norm and $\|.\|_{p, q}$ denotes the matrix $(p, q)$ norm defined as:
\begin{align*}
    \|A\|_{p, q} = \biggRound{\sum_j\biggRound{\sum_{i}|A_{ij}|^p}^{q/p}}^{1/q}
\end{align*}    

\noindent Define the following class of two-layer neural networks:
\begin{align*}
    \F_\mathcal{A} = \bigCurl{
        x\mapsto A_2\sigma(A_1x) : \bigRound{A_1, A_2}\in\mathcal{A}, \ \sigma \text{ is } \rho\text{-Lipchitz w.r.t } \|.\|_2, \ \|x\|_2 \le 1
    }
\end{align*}

\noindent Derive the Rademacher Complexity bound for the class of loss functions:
\begin{align*}
    \mathcal{L}_r = \biggCurl{
        (x, y) \mapsto l_r\bigRound{
            F_\vecbf{A}(x)_y - \max_{k\ne y}F_\vecbf{A}(x)_k
        } \Bigg| F_\vecbf{A} \in \F_\mathcal{A}
    }
\end{align*}

\noindent Where $l_r$ is the ramp loss with margin $r\in(0,1)$.

\subsubsection{Solution}

\textbf{1. Bounding the covering number for $\mathcal{L}_r$} : Let $L_\vecbf{A} \in \mathcal{L}_r$ parameterized by $\vecbf{A}\in\mathcal{A}$ be defined as:
\begin{align*}
    L_\vecbf{A}(x, y) = l_r\bigRound{
        F_\vecbf{A}(x)_y - \max_{k\ne y} F_\vecbf{A}(x)_k
    }
\end{align*}

\noindent Then let $S=\bigCurl{(x_i, y_i)}_{i=1}^n$ be a sample dataset, for $L_\vecbf{A}, L_\vecbf{\bar A}\in\mathcal{L}_r$ and $(x_i, y_i)\in S$, we have:
\begin{align*}
    \bigAbs{L_\vecbf{A}(x_i, y_i) - L_\vecbf{\bar A}(x_i, y_i)} &= \bigAbs{
        l_r\bigRound{
            F_\vecbf{A}(x_i)_y - \max_{k\ne y} F_\vecbf{A}(x_i)_k
        } - 
        l_r\bigRound{
            F_\vecbf{\bar A}(x_i)_y - \max_{k\ne y} F_\vecbf{\bar A}(x_i)_k
        }
    } \\
    &\le \frac{1}{r} \bigAbs{
        \bigRound{F_\vecbf{A}(x_i)_y - F_\vecbf{\bar A}(x_i)_y} +
        \bigRound{
            \max_{k\ne y} F_\vecbf{\bar A}(x_i)_k - \max_{k\ne y} F_\vecbf{A}(x_i)_k
        }
    } \ \ \ \text{($l_r$ is $1/r$-Lipchitz)} \\
    &\le \frac{1}{r} \bigAbs{
        F_\vecbf{A}(x_i)_y - F_\vecbf{\bar A}(x_i)_y
    } + \frac{1}{r}\max_{k\ne y}\bigAbs{
        F_\vecbf{\bar A}(x_i)_k - F_\vecbf{A}(x_i)_k
    } \\
    &\le \frac{2}{r}\max_{j\in\{1, \dots, K\}} \bigAbs{F_\vecbf{A}(x_i)_j - F_\vecbf{\bar A}(x_i)_j}
\end{align*}
